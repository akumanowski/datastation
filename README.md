## DataStation 0.01
### Описание
Проект DataStation — это консольное приложение предназначенное для получения и хранения данных, 
а также формирования отчетов. Данные импортируются из xlsx-файлов, хранятся в базе SQLite.
Отчеты генерируются в текстовом формате.

### Структура таблицы datastream
```
CREATE TABLE datastream (
	id INTEGER NOT NULL, 
	sid VARCHAR NOT NULL, 
	company VARCHAR(10) NOT NULL, 
	date DATE, 
	fact_qliq_1 INTEGER NOT NULL, 
	fact_qliq_2 INTEGER NOT NULL, 
	fact_qoil_1 INTEGER NOT NULL, 
	fact_qoil_2 INTEGER NOT NULL, 
	forecast_qliq_1 INTEGER NOT NULL, 
	forecast_qliq_2 INTEGER NOT NULL, 
	forecast_qoil_1 INTEGER NOT NULL, 
	forecast_qoil_2 INTEGER NOT NULL, 
	PRIMARY KEY (id)
);

CREATE UNIQUE INDEX ix_datastream_id ON datastream (id);
```
### Используемые технологии
```
Python 3.10 - среда выполнения
SQLAlchemy 2.0.15 - ORM для доступа к базе данных, включая SQLite
python-dotenv 1.00.0 - загрузка переменных окружения из файла .env
openpyxl 3.1.2 - чтение/запись файлов Excel 2010 xlsx/xlsb/xltx/xltm
click 8.1.3 - интерфейс командной строки
```
Это тестовый проект, в котором отрабатываются навыки разработки консольного приложения с доступом к базе данных, 
загрузкой данных из файлов Excel, выполнения запросов к базе данных и формирования отчетов.
### Примеры запуска скрипта
#### 1. Получаем информацию о параметрах запуска скрипта
```
# Командная строка:

python3 datastation.py --help

# Результат работы скрипта:

Usage: datastation.py [OPTIONS]

  DataStation — Программа для получения и хранения данных, формирования
  отчетов на основе этих данных.

Options:
  -h, --help           Показать это сообщение и выйти
  -l, --load           Загрузить данные из файла
  -f, --filename TEXT  Файл для загрузки  [default: data_packet.xlsx]
  -d, --date TEXT      Дата загружаемых данных  [default: 2023-05-25]
  -r, --report         Вывести отчет
```
#### 2. Загрузить данные из файла по умолчанию
```
# Командная строка:

python3 datastation.py -l

# Результат работы скрипта:

Чтение данных из файла data_packet.xlsx завершено.
База данных подготовлена для загрузки.
Загрузка данных, актуальных на дату 2023-05-25 выполнена.
```
#### 3. Загрузить данные из произвольного файла с установкой произвольной даты
```
# Командная строка:

python3 datastation.py -l -f /home/user/Documents/new-file.xlsx -d 2023-05-26

# Результат работы скрипта:

Чтение данных из файла /home/user/Documents/new-file.xlsx завершено.
База данных подготовлена для загрузки.
Загрузка данных, актуальных на дату 2023-05-26 выполнена.

```
#### 4. Вывести отчет, сгруппированный по датам
```
# Командная строка:

python3 datastation.py -r

# Результат работы скрипта:

База данных подготовлена для формирования отчета.
Отчет сформирован:
+------------+-------------------------------+-------------------------------+
|            |              Fact             |           Forecast            |
|            |---------------+---------------+---------------+---------------+
|    Date    |      Qliq     |      Qoil     |      Qliq     |      Qoil     |
|            |-------+-------+-------+-------+-------+-------+-------+-------+
|            | Data1 | Data2 | Data1 | Data2 | Data1 | Data2 | Data1 | Data2 |
+------------+-------+-------+-------+-------+-------+-------+-------+-------+
| 25.05.2023 |  390  |  590  |  790  |  990  |  430  |  630  | 1250  | 1450  |
+------------+-------+-------+-------+-------+-------+-------+-------+-------+
| 26.05.2023 | 3710  | 3137  | 2677  | 2742  | 2849  | 3324  | 2612  | 3470  |
+------------+-------+-------+-------+-------+-------+-------+-------+-------+
```
### Как запустить проект на локальной машине:

Клонировать репозиторий на локальный компьютер и перейти в папку datastation:

```
git clone https://github.com/akumanowski/datastation.git
```

```
cd datastation
```

Создать виртуальное окружение:

```
python3 -m venv env
```

Активировать виртуальное окружение:
- для Windows
```
env/bin/activate
```
- для Linux
```
source venv/bin/activate
```

Установить зависимости из файла requirements.txt:

```
python3 -m pip install --upgrade pip
```

```
pip install -r requirements.txt
```
Создать файл хранения переменных окружения .env и заполнить его данными:

```
# .env
DATABASE_NAME=db.sqlite3
```

Запустить проект:

```
python3 datastation.py --help
```